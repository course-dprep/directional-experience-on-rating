---
title: "document_project_data_preparation_group10_PDFmarkup"
author: "Group 10"
<<<<<<< HEAD
date: "2025-10-09"
output: pdf_document
=======
date: "2025-10-10"
output:
word_document: default
pdf_document: default
>>>>>>> ebe3d8d287c92e3c7464876d4534460f9cdc5c5a
---

Daan Bankers              snr:2100281
Luc Vesters				        snr:2145531
Seppe Bogers				      snr:2080522
Melvin Hong				        snr:2146253
Wouter van der Linden			snr:2116790
Marvin Herwig			      	snr:2138521


```{r analysis_packages, echo = FALSE, message=FALSE, warning=FALSE}
# Loading packages
library(dplyr)
library(GGally)
library(ggplot2)
library(tidyr)
<<<<<<< HEAD
library(kableExtra)
setwd("../")
=======
>>>>>>> ebe3d8d287c92e3c7464876d4534460f9cdc5c5a
```

# Does directional experience influence IMDb ratings? 
## Examining how director experience predicts IMDb ratings and how this relationship differs between drama and action movies.

### Introduction

#### Research Question

To what extent does a director’s experience (measured as the cumulative number of minutes of all movies previously directed) predict a movie’s IMDb rating, and is this relationship moderated by movie genre (drama vs. action)?

#### Academical Relevance
This study contributes to research on the movie industry by examining how directors’ cumulative experience predicts movie evaluations. IMDb ratings capture consumer evaluation patterns. Prior research has shown that a director’s experience also influences movie outcomes. Directors with more experience are more likely to produce movies that achieve higher ratings (John et al., 2014). Furthermore, genre could play a crucial role. Francemone et al. (2023) examined 9,068 movies over twenty years and found that action movies tend to be more popular, resulting in higher box office numbers and more IMDb reviews than drama movies. However, drama movies are strongly associated with critical acclaim and receive higher ratings (Francemone et al., 2023). This evidence highlights the importance of considering genre when analysing how directorial experience relates to movie ratings.

#### Managerial Relevance
For studios and investors, insights into how directors’ experience influences audience evaluations have clear practical value. If director experience correlates with IMDb ratings, hiring decisions become easier. Experience may serve as a signal of quality and predictability of outcomes. Moreover, it is essential to consider differences between genres. Dramas typically rely more on director-driven elements (Francemone et al., 2023). In this context, directorial experience is more likely to enhance quality and reduce both artistic and commercial risk. Action movies, by contrast, often depend more heavily on technical production capacities. Here, managers may mitigate risk more effectively by investing in technical teams rather than relying solely on director experience. For decision-makers, this implies a differentiated allocation of talent and budget.

#### Statistical Testing Method
Multiple regression analysis is suitable for testing a metric independent variable (director experience) and a metric dependent variable (IMDb rating), while including a non-metric moderator (genre: drama vs. action). This method estimates the direct and indirect effects within a single model. It also allows for the inclusion of control variables, making the results more interpretable.

### Creating the raw data set

#### Packages and folders
The packages required for this project are listed in the installpackages.R script in the root directory of this project. The download.R script ensures that the correct working directories are set and that folders and subfolders are created and placed in the appropriate locations.

#### Datasets that will be used in this project
This project uses datasets from IMDb. The following IMDb datasets are used:
- name.basics.tsv
- title.basics.tsv
- title.crew.tsv
- title.ratings.tsv

#### Adjustments to create the raw dataset
The title.basics.tsv file is filtered immediately after download. This dataset contains a variable called primaryTitle, which describes the type of video material. Only entries where primaryTitle equals "movie" are retained, as TV series, shorts, and other formats should not be included in this analysis. Only columns relevant to our research question (tconst, runtimeMinutes, genres, startYear) were kept due to the large file size.

After filtering title.basics.tsv, the name.basics.tsv, title.crew.tsv, title.ratings.tsv, and the filtered version of title.basics.tsv were saved as .csv files. These were read into RStudio and merged using a full join to retain the maximum amount of data. The merged dataset was then saved as imdb_movies.csv. (The process of merging and saving is detailed in the clean_and_merge.R script.)

#### Operationalisation tabels 
Operationalisation tables provide more information about the variables included in the dataset. The tables are named name_basics_cols, title_crew_cols, title_basics_cols, and title_ratings_cols (shown below).


```{r preparing_data, include=TRUE}
library(tibble)
library(knitr)   # voor kable
library(gt)      # optioneel, voor mooiere tabellen

# Column descriptions ----

name_basics_cols <- tibble(
  column = c("nconst", "primaryName", "birthYear", "deathYear", "primaryProfession", "knownForTitles"),
  description = c(
    "alphanumeric unique identifier of the name/person",
    "name by which the person is most often credited",
    "in YYYY format",
    "in YYYY format if applicable, else '\\N'",
    "the top-3 professions of the person",
    "titles the person is known for"
  )
)

title_crew_cols <- tibble(
  column = c("tconst", "directors", "writers"),
  description = c(
    "alphanumeric unique identifier of the title",
    "director(s) of the given title",
    "writer(s) of the given title"
  )
)

title_basics_cols <- tibble(
  column = c("tconst", "titleType", "primaryTitle", "originalTitle", "isAdult", "startYear", "endYear", "runtimeMinutes", "genres"),
  description = c(
    "alphanumeric unique identifier of the title",
    "the type/format of the title (e.g. movie, short, tvseries, tvepisode, video, etc)",
    "the more popular title / the title used by the filmmakers on promotional materials at the point of release",
    "the original title, in the original language",
    "0: non-adult title; 1: adult title",
    "represents the release year of a title. In the case of TV Series, it is the series start year",
    "TV Series end year. '\\N' for all other title types",
    "primary runtime of the title, in minutes",
    "includes up to three genres associated with the title"
  )
)

title_ratings_cols <- tibble(
  column = c("tconst", "averageRating", "numVotes"),
  description = c(
    "alphanumeric unique identifier of the title",
    "weighted average of all the individual user rating",
    "number of votes the title has received"
  )
)
```

<<<<<<< HEAD








#### handling missing values and class problems

The missing values in the "imdb_movies_dataset" were indicated with the as "\\N". the code used indicated the missing values with NA. This because  functions like "rm.na" or "is.na"  were easier to work with and it makes analysis easier. Finally the class of runtimeMinutes changed into an integer and the class of startYear changed to numeric. Both these variables were classified as characters. by changing them, stats could be performed and proper comparisions could be performed as well. These changes were saved in a new csv file called: "imdb_movies.csv" 

### cleaning data for the direct effect
From the "imdb_movies.csv" dataset, the 5% extreme values in the dataset will be ignored. This because statistical models can be sensitive for extreme outliers. That is the reason why this project ignores these extreme values. This project only uses films that are created from 1990 onwards. The digital revolution started in 1990 and changed the film industry as well. New digital visual effects could be used in films because of this revolution. The observations are also filtered in a way that the na's are ignored as well. A seperate row function makes sure that every director has its own row, because there are observations that included multiple directors. Finally, three columns are added to the dataset. The column "total_runtime" which is the sum of the runtime in minutes. This way we were able to get the total_runtime of film that a director produced in its career. The second column is "avg_rating" which is the mean of the average_rating of all films that the director created. The last column is n_films column which counts the amount of films that a director has made. All these adjustements are saved in a .csv file called "imdb_movies_direct.csv". (All the steps mentioned in this paragraph are shown in the dataprep_directeffect.R rscript.)
=======
#### Handling missing values and class problems
Missing values in imdb_movies were indicated as "\\N". These were replaced with NA to facilitate functions such as rm.na and is.na, which make analysis easier. The class of runtimeMinutes was changed to integer, and startYear to numeric, as both were originally classified as characters. These changes allow for statistical computations and proper comparisons. The cleaned dataset was saved as a new CSV file named imdb_movies.csv.
>>>>>>> ebe3d8d287c92e3c7464876d4534460f9cdc5c5a

### Cleaning data for the direct effect
From the “imdb_movies.csv” file, the 5% most extreme values in the dataset will be excluded. This is because the results are not normally distributed when we do not exclude the 5% most extreme values. The dataset contains some extreme points with a total runtime over 15,000 minutes. Normality is needed when we want to run a multiple linear regression. That is the reason why the 5% extreme values will be excluded. This project only uses films that were released from 1990 onwards. The digital revolution started in 1990 and changed the film industry as well. New digital visual effects could be used in films because of this revolution. The observations are also filtered so that the NAs are ignored as well. A separate row function ensures that every director has their own row, because there are observations that include multiple directors. Finally, three columns are added to the dataset. The column “total_runtime” represents the sum of the runtime in minutes. This way we were able to get the total_runtime of films that a director produced over their career. The second column is “avg_rating,” which is the mean of the average_rating of all films that the director created. The last column is the “n_films” column, which counts the number of films that a director has made. All these adjustments are saved in a .csv file called “imdb_movies_direct.csv”. (All the steps mentioned in this paragraph are shown in the dataprep_directeffect.R R script.)

<<<<<<< HEAD
### cleaning the data for the moderate effect
The "imdb_movies.csv" dataset will be used for the moderate effect as well. The data cleaning of the moderate effect is very similar to the data cleaning of the direct effect. For example, the 5% extreme values will similarly be ignored as in the direct effect because statistical models can be senstive to robust outliers. Na's will also be similarly removed and start_year is filtered from 1990 onwards. The moderate dataset makes sure that every genre has it own row. This is managed through the seperate row function that is used. Genres are also filtered by "Drama" and "Action" because these are the genres that we focus on in our research. Finally, four columns are added in the moderate effect dataset: total_runtime, avg_rating, n_films and most_common_genre. The first three columns are created in the same way as in the direct effect dataset. The most_common_genre column and it provides the most common genres. All adjustments will be saved as csv file called "imdb_movies_mod.csv". (All the steps mentioned in this paragraph are shown in the dataprep_modeeffect.R rscript.)
=======
#hier mogelijk nog een plot plaatsen van de normale verdeling

### Cleaning the data for the moderate effect
The “imdb_movies.csv” dataset will be used for the moderate effect as well. The data cleaning of the moderate effect is very similar to the data cleaning of the direct effect. For example, the 5% most extreme values will similarly be excluded, as in the direct effect, to fulfil the normality assumption. NAs will also be similarly removed, and start_year will be filtered from 1990 onwards. The moderate dataset ensures that every genre has its own row. This is managed through the separate row function that is used. Genres are also filtered by “Drama” and “Action” because these are the genres that we focus on in our research. Finally, four columns are added to the moderate effect dataset: total_runtime, avg_rating, n_films, and most_common_genre. The first three columns are created in the same way as in the direct effect dataset. The most_common_genre column provides the most common genre. All adjustments will be saved as a CSV file called “imdb_movies_mod.csv”. (All the steps mentioned in this paragraph are shown in the dataprep_modeeffect.R R script.)
>>>>>>> ebe3d8d287c92e3c7464876d4534460f9cdc5c5a

### Conclusion of this analysis
The data from the imdb_movies_direct.csv file was used in Analysis.R to run the linear regression for the direct effect, with avg_rating as the dependent variable and total_runtime as the independent variable. The results indicate that directors with more experience tend to receive slightly lower ratings. Although this effect is statistically significant (p < 2e-16), the adjusted R² is very low (0.00555), suggesting that director experience explains very little of the variation in movie ratings. A scatterplot created to visualize this relationship can be found in the following folder: plots/Runtime_on_average_rating.jpg.

<<<<<<< HEAD
For the moderation effect, data from imdb_movies_mod.csv was used, again with avg_rating as the dependent variable and total_runtime as the independent variable in Analysis.R, while including most_common_genreDrama as a moderator. The results show that total_runtime is no longer a significant predictor on its own (p = 0.168626), but both most_common_genreDrama (p < 2e-16) and the interaction between total_runtime and most_common_genreDrama (p = 0.000716) are significant. This suggests that the relationship between director experience and rating differs by genre: for drama movies, the negative relationship between director experience and ratings is slightly stronger than for action movies. However, action movies show a slightly positive increase in the relationship between director experience and their average rating. The low adjusted R² (0.03277) makes this relationship still lack practical significance. A scatterplot created to visualize this moderation effect can also be found in the following folder: plots/Moderating_effect.jpg.
```{r}
setwd("../")
imdb_movies_direct <- read_csv("gen/temp/imdb_movies_direct.csv")
imdb_movies_mod <- read_csv("gen/temp/imdb_movies_mod.csv")
```

### Results from the linear regression
```{r}
linearregression_directeffect <- lm(avg_rating ~ total_runtime, data = imdb_movies_direct)
summary(linearregression_directeffect)
```
```{r}
imdb_movies_mod$most_common_genre <- factor(imdb_movies_mod$most_common_genre)
linear_model_moderatinginteraction <- lm(avg_rating ~ total_runtime * most_common_genre,
                               data = imdb_movies_mod)
summary(linear_model_moderatinginteraction)
```

=======
# WE CREATED ANALYSIS AND VISUALIZATIONS BY USING THE FOLLOWING PACKAGES: DPLYR, GGALLY, GGPLOT2, TIDYR

```{r analysis_packagesecho = FALSE, message=FALSE, warning=FALSE}
# Loading packages
library(dplyr)
library(GGally)
library(ggplot2)
library(tidyr)
library()
```

# WE CREATED SOME MULTIPLE LINEAR REGRESSIONS, WHICH YOU CAN SEE IN THIS ANALYSIS

```{r regression_analysis}
# input from the dataprep_directeffect and dataprep_modeffect
readr::write_csv(director_stats, "directeffect_data.csv")
readr::write_csv(data_mod, "modeffect_data.csv")

# Creating a new variable for director_stats
director_stats$total_runtime <- director_stats$avg_runtime * director_stats$film_count

# Regression model
model <- lm(avg_rating ~ total_runtime, data = director_stats)
summary(model)



# Regression with the moderator: first regression model integration with the moderator
data_mod$dominant_genre <- factor(data_mod$dominant_genre, levels = c("Drama", "Action"))

lrmmod <- lm(avg_rating ~ total_runtime * dominant_genre, data = data_mod)
summary(lrmmod)

# Output results from the lrmmod
lrmmodel_summary <- summary(lrmmod)
coef_lrmmod <- as.data.frame(lrmmod_summary$coefficients)
coef_lrmmod$Term <- ownames(coef_lrmmod)
coef_lrmmod <- coef_lrmmode\[, c("Term", "Estimate", "Std. Error", "t value", "Pr(>|t|)")\]
write.csv(coef_lrmmod,"analysis.csv", row.names = FALSE)
```
# CREATE THE CONCLUSION WE CAN DRAW FROM THIS ANALYSIS

# BELOW WE CREATED SOME VISUALIZATIONS TO LET YOU SEE OUR REGRESSION MODEL
>>>>>>> ebe3d8d287c92e3c7464876d4534460f9cdc5c5a

###Visualisations of the regression model
`

```{r}
 ggplot(imdb_movies_direct, aes(x = total_runtime, y = avg_rating)) +
  geom_point(color = "#007BFF", alpha = 1, size = 0.5) +                
  geom_smooth(method = "lm", color = "red", se = TRUE) +
  labs(
    title = "The relationship between total runtime and average rating",
    x = "Total runtime (minutes)",
    y = "Average rating"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 14, color = "#3A0CA3"),
    plot.subtitle = element_text(size = 13, color = "#7209B7"),
    axis.title = element_text(face = "bold", color = "#264653"),
    axis.text = element_text(color = "#333333"),
    panel.grid.major = element_line(color = "#F1F1F1"),
    panel.grid.minor = element_blank(),
    plot.background = element_rect(fill = "#FFF9F3", color = NA),
    panel.background = element_rect(fill = "#FFF9F3", color = NA),
    legend.position = "right",
    legend.background = element_rect(fill = "#FFF9F3", color = NA)
  )
```

<<<<<<< HEAD
```{r}
 ggplot(imdb_movies_mod, aes(x = total_runtime, y = avg_rating, color = most_common_genre)) +
  geom_point(alpha = 0.6, size = 0.7) +
  geom_smooth(method = "lm", se = TRUE, linewidth = 1.2) +
  facet_wrap(~most_common_genre) +
  scale_color_manual(values = c("Action" = "#FF6B6B", "Drama" = "#1F77B4")) +
  labs(
    title = "Runtime & Genre on Average Rating, with an interaction effect",
    x = "Total Runtime (minutes)",
    y = "Average IMDb Rating",
    color = "Genre"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 14, color = "#3A0CA3"),
    plot.subtitle = element_text(size = 12, color = "#7209B7"),
    axis.title = element_text(face = "bold", color = "#264653"),
    axis.text = element_text(color = "#333333"),
    panel.grid.major = element_line(color = "#F1F1F1"),
    panel.grid.minor = element_blank(),
    plot.background = element_rect(fill = "#FFF9F3", color = NA),
    panel.background = element_rect(fill = "#FFF9F3", color = NA),
    legend.position = "right",
    legend.background = element_rect(fill = "#FFF9F3", color = NA)
  )
```

=======
# SHOW A CONCLUSION
The data from the imdb_movies_direct.csv file was used in Analysis.R to run the linear regression for the direct effect, with avg_rating as the dependent variable and total_runtime as the independent variable. The results indicate that directors with more experience tend to receive slightly lower ratings. Although this effect is statistically significant (p < 2e-16), the adjusted R² is very low (0.00555), suggesting that director experience explains very little of the variation in movie ratings. A scatterplot created to visualize this relationship can be found in the following folder: plots/Runtime_on_average_rating.jpg.

For the moderation effect, data from imdb_movies_mod.csv was used, again with avg_rating as the dependent variable and total_runtime as the independent variable in Analysis.R, while including most_common_genreDrama as a moderator. The results show that total_runtime is no longer a significant predictor on its own (p = 0.168626), but both most_common_genreDrama (p < 2e-16) and the interaction between total_runtime and most_common_genreDrama (p = 0.000716) are significant. This suggests that the relationship between director experience and rating differs by genre: for drama movies, the negative relationship between director experience and ratings is slightly stronger than for non-drama movies. However, due to the low adjusted R² (0.03277), this relationship still lacks practical significance. A scatterplot created to visualize this moderation effect can also be found in the following folder: plots/Moderating_effect.jpg.
>>>>>>> ebe3d8d287c92e3c7464876d4534460f9cdc5c5a
