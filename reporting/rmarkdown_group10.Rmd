---
title: "document_project_data_preparation_group10_PDFmarkup."
author: "Group 10"
date: "2025-09-04"
output:
  word_document: default
  pdf_document: default
---

Daan Bankers              snr:2100281
Luc Vesters				        snr:2145531
Seppe Bogers				      snr:2080522
Melvin Hong				        snr:2146253
Wouter van der Linden			snr:2116790
Marvin  Herwig			    	snr:2138521

Research Question

To what extent does a director’s experience( measured as the cumulative number of minutes of all movies previously directed) predict a movie’s IMDb rating, and is this relationship moderated by movie genre (drama vs. action)?

Academically Relevant

This study contributes to research on the movie industry by examining how directors’ cumulative experience predicts movie evaluations. We use total directed minutes, which captures experience more precisely. Then the length of the movies give less experience when it’s rather short than a few very long ones. The IMDb ratings capture consumer evaluation patterns. Furthermore, genre could play a crucial role, given that the genre drama is more critically evaluated than the genre action, which is more popular. This suggests genre could moderate this relationship.

Managerially Relevant

For studios and investors facing uncertainty, insights into how directors experience influences audience rating are useful. If experience predicts higher quality, the decision for an experienced director could be made easier. Recognizing genre differences helps managers allocate talent effectively. While technical production could dominate the genre drama. This reduces risk and aligns creative choices with market demands.

Statistical Testing Method

Multiple regression analysis is suitable for testing a metric independent variable(director experience) and a metric independent variable(IMDb rating), while including a nonmetric moderator (genre: drama vs. action). By applying this method, this estimates the direct and indirect effect in a single model. It also allows controlling for other factors, making the results more interpretable.

#Rscripts#
In the first script, we (down)load the packages needed to run the complete Rscript. 

```{r load_packages, echo=FALSE, message=FALSE, warning=FALSE}

#required packages
load_pkg <- function(pkg){
  if(!require(pkg, character.only = TRUE)){
    install.packages(pkg, dependencies = TRUE)
    library(pkg, character.only = TRUE)
  }
}
packages <- c("readr", "tidyverse")
lapply(packages, load_pkg)

```


#TEKST INVOEGEN MET UITLEGGEN WAT ER GEBEURT IN ONDERSTAANDE RSCRIPT

```{r download_data, echo = FALSE, message=FALSE, warning=FALSE}
#set directory
data_dir <- "../../data/raw_data"

# Creating folder
if(!dir.exists("data/raw_data")){
  dir.create("data/raw_data", recursive = TRUE)
}

# URLs for the IMDb datasets
urls <- list(
  ratings = "https://datasets.imdbws.com/title.ratings.tsv.gz",
  crew = "https://datasets.imdbws.com/title.crew.tsv.gz",
  name_basics = "https://datasets.imdbws.com/name.basics.tsv.gz",
  title_basics = "https://datasets.imdbws.com/title.basics.tsv.gz"
)

for(name in names(urls)){
  destfile <- paste0("data/raw_data/", name, ".tsv.gz")
  if(!file.exists(destfile)){
    download.file(urls[[name]], destfile)
  }
}



```

#EXPLAIN HOW WE CREATED THE DATASET AND WHY WE USED THE FULLJOIN METHOD(MAXIMIZED DATA) AND WHAT WE CREATED TO GET OUR MAIN DATASET


```{r preparing_data, echo = FALSE, message=FALSE, warning=FALSE}
#Merge data in a single datafile
imdb_movies <- title_basics
imdb_movies <- imdb_movies %>%
  full_join(title_ratings, by = "tconst") %>%
  full_join(title_crew, by = "tconst")

# Save as csv
readr::write_csv(imdb_movies, "data/imdb_movies_dataset.csv")

# Column description
name_basics_cols <- tibble(
  column = c("nconst", "primaryName", "birthYear", "deathYear", "primaryProfession", "knownForTitles"),
  description = c(
    "alphanumeric unique identifier of the name/person",
    "name by which the person is most often credited",
    "in YYYY format",
    "in YYYY format if applicable, else '\\N'",
    "the top-3 professions of the person",
    "titles the person is known for"
  )
)

title_crew_cols <- tibble(
  column = c("tconst", "directors", "writers"),
  description = c(
    "alphanumeric unique identifier of the title",
    "director(s) of the given title",
    "writer(s) of the given title"
  )
)

title_basics_cols <- tibble(
  column = c("tconst", "titleType", "primaryTitle", "originalTitle", "isAdult", "startYear", "endYear", "runtimeMinutes", "genres"),
  description = c(
    "alphanumeric unique identifier of the title",
    "the type/format of the title (e.g. movie, short, tvseries, tvepisode, video, etc)",
    "the more popular title / the title used by the filmmakers on promotional materials at the point of release",
    "the original title, in the original language",
    "0: non-adult title; 1: adult title",
    "represents the release year of a title. In the case of TV Series, it is the series start year",
    "TV Series end year. '\\N' for all other title types",
    "primary runtime of the title, in minutes",
    "includes up to three genres associated with the title"
  )
)

title_ratings_cols <- tibble(
  column = c("tconst", "averageRating", "numVotes"),
  description = c(
    "alphanumeric unique identifier of the title",
    "weighted average of all the individual user rating",
    "number of votes the title has received"
  )
)

# Converting \N to NA in imdb_movies
library("dplyr")
imdb_movies <- imdb_movies %>%
  mutate(across(c(runtimeMinutes, genres, startYear, directors, writers), ~ na_if(as.character(.), "\\N")))

# Classing the different data
imdb_movies <- imdb_movies %>%
  mutate(
    startYear = as.integer(startYear),
    runtimeMinutes = as.numeric(runtimeMinutes)
    )
```

# WE CREATED ANALYSIS AND VISUALIZATIONS BY USING THE FOLLOWING PACKAGES: DPLYR, GGALLY, GGPLOT2, TIDYR

```{r analysis_packages}
#Loading packages
library(dplyr)
library(GGally)
library(ggplot2)
library(tidyr)
```

#WE CREATED SOME MULTIPLE LINEAR REGRESSIONS, WHICH YOU CAN SEE IN THIS ANALYSIS

```{r regression_analysis}
# input from the dataprep_directeffect and dataprep_modeffect
readr::write_csv(director_stats, "directeffect_data.csv")
readr::write_csv(data_mod, "modeffect_data.csv")

# Creating a new variable for director_stats
director_stats$total_runtime <- director_stats$avg_runtime * director_stats$film_count

# Regressionmodel
model <- lm(avg_rating ~ total_runtime, data = director_stats)
summary(model)



# Regression with the moderator: first regression model integration with the moderator
data_mod$dominant_genre <- factor(data_mod$dominant_genre, levels = c("Drama", "Action"))

lrmmod <- lm(avg_rating ~ total_runtime * dominant_genre, data = data_mod)
summary(lrmmod)

#Output results from the lrmmod
lrmmodel_summary <- summary(lrmmod)
coef_lrmmod <- as.data.frame(lrmmod_summary$coefficients)
coef_lrmmod$Term <- ownames(coef_lrmmod)
coef_lrmmod <- coef_lrmmode\[, c("Term", "Estimate", "Std. Error", "t value", "Pr(>|t|)")\]
write.csv(coef_lrmmod,"analysis.csv", row.names = FALSE)
```
#CREATE THE CONCLUSION WE CAN DRAW FROM THIS ANALYSIS

#BELOW WE CREATED SOME VISUALIZATIONS TO LET YOU SEE OUR REGRESSION MODEL

```{r visualization_analysis}
# ggpairs plot
ggpairs(director_stats,
        columns = c("avg_rating", "film_count", "avg_runtime"),
        title = "Director Statistics")

# Creating a new variable for director_stats
director_stats$total_runtime <- director_stats$avg_runtime * director_stats$film_count

# Scatterplot with regressionline
ggplot(director_stats %>% dplyr::filter(total_runtime <= 20000),
       aes(x = total_runtime, y = avg_rating)) +
  geom_point(color = "blue", alpha = 0.6, size = 3) +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  labs(
    x = "Total runtime (avg_runtime * film_count)",
    y = "Average rating",
    title = "Linear Regression: Runtime vs Rating (≤ 20,000)"
  ) +
  theme_minimal()
```


#SHOW A CONCLUSION
